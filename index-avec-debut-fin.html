<!DOCTYPE html>
<html>
<meta charset="utf-8">
  <head>
    <!-- CSS -> Style -->
    <style media="screen">
      h1,
      h2,
      h3 {
        text-align: center;
      }
      table,
      td,
      tr {
        border: 1px solid #333;
        align: center;
      }
      table {
        width: 50%;
      }
      thead,
      tfoot {
        background-color: #333;
        color: #fff;
      }
      .center {
        margin-left: auto;
        margin-right: auto;
        text-align: center;
        vertical-align: middle;
      }
    </style>
    <!-- Javascript -> Logic -->
    <script type="text/javascript">
      function removeLastDirectoryPartOf(the_url) {
        var the_arr = the_url.split("/");
        the_arr.pop();
        return the_arr.join("/");
      }
      function download(dataurl, filename) {
        const link = document.createElement("a");
        link.href = dataurl;
        link.download = filename;
        link.click();
      }
      function checkAndUncheck() {
        var isChecked = false;
        var inputs = document.getElementsByTagName("input");
        var buttonCheckAll = document.getElementById("buttonCheckAll");
        for (var i = 0; i < inputs.length; ++i) {
          if (inputs[i].checked === true) {
            isChecked = true;
            break;
          }
        }
        for (var i = 0; i < inputs.length; ++i) {
          inputs[i].checked = !isChecked;
        }
        if (isChecked) {
          buttonCheckAll.value = "Tout cocher";
        } else {
          buttonCheckAll.value = "Tout decocher";
        }
      }
      function checkMinMax() {
        var inputs = document.getElementsByClassName("checkBox");
        var min = document.getElementById("min").value;
        var max = document.getElementById("max").value;
        
        console.log("min: " + min)
        console.log("max: " + max)
        console.log("inputs.length: " + inputs.length)
        
        
        for (var i = min; i < max; ++i) {
          inputs[i].checked = true;
        }
      }
      function downloadAllItems() {
        var concatenateUrlForDownload = "";
        var inputs = document.getElementsByTagName("input");
        const HOST_URL = window.location.href;
        for (var i = 0; i < inputs.length; ++i) {
          if (inputs[i].checked && inputs[i].id != "buttonCheckAll") {
            console.log("inputs[i].id: '" + inputs[i].id +"'");
            concatenateUrlForDownload =
              removeLastDirectoryPartOf(HOST_URL) +"/"+ inputs[i].id;
            console.log(
              "concatenateUrlForDownload: '" + concatenateUrlForDownload +"'"
            );
            download(concatenateUrlForDownload, inputs[i].id);
          }
        }
      }
    </script>
  </head>
  <!-- HTML -> Struct -->
  <body>
    <div>
      <div>
        <h1 class="center">Serveur de fichiers</h1>
      </div>
      <div>
        <h3>ðŸ˜¼ FabLab made in Iki ðŸ˜¼</h3>
      </div>
    </div>
      <div class="center">
        <input
          onclick="checkAndUncheck()"
          type='button'
          value='Tout cocher'
          id='buttonCheckAll'
        />
        <button onclick="downloadAllItems()" type="submit">
          Tout tÃ©lÃ©charger
        </button>
      </div>
      <br />
          <div class="center">
            <input type="number" id="min" min=0 value=0>
            <input type="number" id="max" min=0 value=5>
                            <input
          onclick="checkMinMax()"
          type='button'
          value='Cocher min a max'
          id='buttonCheckAll'
        />
    </div>
    <br />
    <div>
      <div>
        <table class="center">
          <thead>
            <tr>
              <th colspan="2">Documents disponibles</th>
            </tr>
          </thead>
          <tbody>
<tr><td><input class="checkBox" id="20220519"type="checkbox" /></td><td>20220519</td></tr>
<tr><td><input class="checkBox" id="20220530"type="checkbox" /></td><td>20220530</td></tr>
<tr><td><input class="checkBox" id="20220531"type="checkbox" /></td><td>20220531</td></tr>
<tr><td><input class="checkBox" id="20220601"type="checkbox" /></td><td>20220601</td></tr>
<tr><td><input class="checkBox" id="20220602"type="checkbox" /></td><td>20220602</td></tr>
<tr><td><input class="checkBox" id="20220603"type="checkbox" /></td><td>20220603</td></tr>
<tr><td><input class="checkBox" id="2165165165"type="checkbox" /></td><td>2165165165</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </body>
</html>
